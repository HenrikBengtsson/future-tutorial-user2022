<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="8.6 Appendix: Missing globals | Tutorial: An Introduction to Futureverse for Parallel Processing in R" />
<meta property="og:type" content="book" />
<meta property="og:image" content="https://www.futureverse.org/figures/future_logo.png" />
<meta property="og:description" content="N/A" />
<meta name="github-repo" content="HenrikBengtsson/future-tutorial-useR2022" />

<meta name="author" content="Henrik Bengtsson" />

<meta name="date" content="2022-06-20" />


<meta name="description" content="N/A">

<title>8.6 Appendix: Missing globals | Tutorial: An Introduction to Futureverse for Parallel Processing in R</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#tutorial-overview" id="toc-tutorial-overview">Tutorial Overview</a>
<ul>
<li><a href="abstract.html#abstract" id="toc-abstract">Abstract</a></li>
<li><a href="objectives.html#objectives" id="toc-objectives">Objectives</a></li>
<li><a href="preparing-for-this-tutorial.html#preparing-for-this-tutorial" id="toc-preparing-for-this-tutorial">Preparing for this tutorial</a></li>
</ul></li>
<li class="has-sub"><a href="hello-and-practicalities.html#hello-and-practicalities" id="toc-hello-and-practicalities">Hello and practicalities</a>
<ul>
<li><a href="practicalities.html#practicalities" id="toc-practicalities">Practicalities</a></li>
<li><a href="agenda.html#agenda" id="toc-agenda">Agenda</a></li>
<li class="has-sub"><a href="polls.html#polls" id="toc-polls">Polls</a>
<ul>
<li><a href="polls.html#poll-1-how-much-do-you-know-about-parallelization-in-r" id="toc-poll-1-how-much-do-you-know-about-parallelization-in-r">Poll #1: How much do you know about parallelization in R?</a></li>
<li><a href="polls.html#poll-2-what-is-your-main-operating-system-when-using-r" id="toc-poll-2-what-is-your-main-operating-system-when-using-r">Poll #2: What is your main operating system when using R?</a></li>
<li><a href="polls.html#poll-3-how-do-you-run-r" id="toc-poll-3-how-do-you-run-r">Poll #3: How do you run R?</a></li>
<li><a href="polls.html#poll-4-do-you-have-access-to-a-cluster" id="toc-poll-4-do-you-have-access-to-a-cluster">Poll #4: Do you have access to a cluster?</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="1-an-overview-of-the-futureverse.html#an-overview-of-the-futureverse" id="toc-an-overview-of-the-futureverse"><span class="toc-section-number">1</span> An Overview of The Futureverse</a>
<ul>
<li><a href="1.1-why-do-we-parallelize.html#why-do-we-parallelize" id="toc-why-do-we-parallelize"><span class="toc-section-number">1.1</span> Why do we parallelize?</a></li>
<li><a href="1.2-the-future-package-the-core-of-it-all.html#the-future-package-the-core-of-it-all" id="toc-the-future-package-the-core-of-it-all"><span class="toc-section-number">1.2</span> The future package (the core of it all)</a></li>
<li class="has-sub"><a href="1.3-quick-intro-evaluate-r-in-the-background.html#quick-intro-evaluate-r-in-the-background" id="toc-quick-intro-evaluate-r-in-the-background"><span class="toc-section-number">1.3</span> Quick intro: Evaluate R in the background</a>
<ul>
<li><a href="1.3-quick-intro-evaluate-r-in-the-background.html#sequentially" id="toc-sequentially"><span class="toc-section-number">1.3.1</span> Sequentially</a></li>
<li><a href="1.3-quick-intro-evaluate-r-in-the-background.html#in-parallel" id="toc-in-parallel"><span class="toc-section-number">1.3.2</span> In parallel</a></li>
</ul></li>
<li class="has-sub"><a href="1.4-quick-intro-parallel-base-r-apply.html#quick-intro-parallel-base-r-apply" id="toc-quick-intro-parallel-base-r-apply"><span class="toc-section-number">1.4</span> Quick intro: Parallel base-R apply</a>
<ul>
<li><a href="1.4-quick-intro-parallel-base-r-apply.html#sequentially-1" id="toc-sequentially-1"><span class="toc-section-number">1.4.1</span> Sequentially</a></li>
<li><a href="1.4-quick-intro-parallel-base-r-apply.html#in-parallel-1" id="toc-in-parallel-1"><span class="toc-section-number">1.4.2</span> In parallel</a></li>
</ul></li>
<li class="has-sub"><a href="1.5-quick-intro-parallel-tidyverse-apply.html#quick-intro-parallel-tidyverse-apply" id="toc-quick-intro-parallel-tidyverse-apply"><span class="toc-section-number">1.5</span> Quick intro: Parallel tidyverse apply</a>
<ul>
<li><a href="1.5-quick-intro-parallel-tidyverse-apply.html#sequentially-2" id="toc-sequentially-2"><span class="toc-section-number">1.5.1</span> Sequentially</a></li>
<li><a href="1.5-quick-intro-parallel-tidyverse-apply.html#in-parallel-2" id="toc-in-parallel-2"><span class="toc-section-number">1.5.2</span> In parallel</a></li>
</ul></li>
<li class="has-sub"><a href="1.6-quick-intro-parallel-foreach.html#quick-intro-parallel-foreach" id="toc-quick-intro-parallel-foreach"><span class="toc-section-number">1.6</span> Quick intro: Parallel foreach</a>
<ul>
<li><a href="1.6-quick-intro-parallel-foreach.html#sequentially-3" id="toc-sequentially-3"><span class="toc-section-number">1.6.1</span> Sequentially</a></li>
<li><a href="1.6-quick-intro-parallel-foreach.html#in-parallel-3" id="toc-in-parallel-3"><span class="toc-section-number">1.6.2</span> In parallel</a></li>
</ul></li>
<li class="has-sub"><a href="1.7-what-is-the-futureverse.html#what-is-the-futureverse" id="toc-what-is-the-futureverse"><span class="toc-section-number">1.7</span> What is the Futureverse?</a>
<ul>
<li><a href="1.7-what-is-the-futureverse.html#packages-part-of-the-futureverse" id="toc-packages-part-of-the-futureverse"><span class="toc-section-number">1.7.1</span> Packages part of the Futureverse</a></li>
<li><a href="1.7-what-is-the-futureverse.html#who-is-it-for" id="toc-who-is-it-for"><span class="toc-section-number">1.7.2</span> Who is it for?</a></li>
<li><a href="1.7-what-is-the-futureverse.html#who-are-using-it" id="toc-who-are-using-it"><span class="toc-section-number">1.7.3</span> Who are using it?</a></li>
<li><a href="1.7-what-is-the-futureverse.html#what-about-its-quality-and-stability" id="toc-what-about-its-quality-and-stability"><span class="toc-section-number">1.7.4</span> What about its quality and stability?</a></li>
<li><a href="1.7-what-is-the-futureverse.html#support" id="toc-support"><span class="toc-section-number">1.7.5</span> Support</a></li>
<li><a href="1.7-what-is-the-futureverse.html#how-to-stay-up-to-date" id="toc-how-to-stay-up-to-date"><span class="toc-section-number">1.7.6</span> How to stay up-to-date</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="2-the-core-future-api.html#the-core-future-api" id="toc-the-core-future-api"><span class="toc-section-number">2</span> The core Future API</a>
<ul>
<li class="has-sub"><a href="2.1-three-atomic-building-blocks.html#three-atomic-building-blocks" id="toc-three-atomic-building-blocks"><span class="toc-section-number">2.1</span> Three atomic building blocks</a>
<ul>
<li><a href="2.1-three-atomic-building-blocks.html#mental-model-the-future-api-decouples-a-regular-r-assignment-into-two-parts" id="toc-mental-model-the-future-api-decouples-a-regular-r-assignment-into-two-parts"><span class="toc-section-number">2.1.1</span> Mental model: The Future API decouples a regular R assignment into two parts</a></li>
<li><a href="2.1-three-atomic-building-blocks.html#keep-doing-other-things-while-waiting" id="toc-keep-doing-other-things-while-waiting"><span class="toc-section-number">2.1.2</span> Keep doing other things while waiting</a></li>
<li><a href="2.1-three-atomic-building-blocks.html#evaluate-several-things-in-parallel" id="toc-evaluate-several-things-in-parallel"><span class="toc-section-number">2.1.3</span> Evaluate several things in parallel</a></li>
</ul></li>
<li class="has-sub"><a href="2.2-choosing-parallel-backend.html#choosing-parallel-backend" id="toc-choosing-parallel-backend"><span class="toc-section-number">2.2</span> Choosing parallel backend</a>
<ul>
<li><a href="2.2-choosing-parallel-backend.html#sequential-default" id="toc-sequential-default"><span class="toc-section-number">2.2.1</span> sequential (default)</a></li>
<li><a href="2.2-choosing-parallel-backend.html#multisession-in-parallel-on-local-computer" id="toc-multisession-in-parallel-on-local-computer"><span class="toc-section-number">2.2.2</span> multisession: in parallel on local computer</a></li>
<li><a href="2.2-choosing-parallel-backend.html#cluster-in-parallel-on-multiple-computers" id="toc-cluster-in-parallel-on-multiple-computers"><span class="toc-section-number">2.2.3</span> cluster: in parallel on multiple computers</a></li>
<li><a href="2.2-choosing-parallel-backend.html#there-are-other-parallel-backends-and-more-to-come" id="toc-there-are-other-parallel-backends-and-more-to-come"><span class="toc-section-number">2.2.4</span> There are other parallel backends and more to come</a></li>
</ul></li>
<li><a href="2.3-motto-and-design-philosophy.html#motto-and-design-philosophy" id="toc-motto-and-design-philosophy"><span class="toc-section-number">2.3</span> Motto and design philosophy</a></li>
<li><a href="2.4-demo-ggplot2-remotely.html#demo-ggplot2-remotely" id="toc-demo-ggplot2-remotely"><span class="toc-section-number">2.4</span> Demo: ggplot2 remotely</a></li>
</ul></li>
<li class="has-sub"><a href="3-map-reduce-apis.html#map-reduce-apis" id="toc-map-reduce-apis"><span class="toc-section-number">3</span> Map-reduce APIs</a>
<ul>
<li class="has-sub"><a href="3.1-parallel-alternatives-to-base-r-apply-functions.html#parallel-alternatives-to-base-r-apply-functions" id="toc-parallel-alternatives-to-base-r-apply-functions"><span class="toc-section-number">3.1</span> Parallel alternatives to base-R apply functions</a>
<ul>
<li><a href="3.1-parallel-alternatives-to-base-r-apply-functions.html#example-baselapplyx-fun" id="toc-example-baselapplyx-fun"><span class="toc-section-number">3.1.1</span> Example: base::lapply(X, FUN)</a></li>
<li><a href="3.1-parallel-alternatives-to-base-r-apply-functions.html#example-basevapplyx-fun-fun.value" id="toc-example-basevapplyx-fun-fun.value"><span class="toc-section-number">3.1.2</span> Example: base::vapply(X, FUN, FUN.VALUE)</a></li>
<li><a href="3.1-parallel-alternatives-to-base-r-apply-functions.html#example-basemapplyx-y-fun" id="toc-example-basemapplyx-y-fun"><span class="toc-section-number">3.1.3</span> Example: base::mapply(X, Y, FUN)</a></li>
</ul></li>
<li><a href="3.2-parallel-alternatives-to-purrr-functions.html#parallel-alternatives-to-purrr-functions" id="toc-parallel-alternatives-to-purrr-functions"><span class="toc-section-number">3.2</span> Parallel alternatives to purrr functions</a></li>
</ul></li>
<li class="has-sub"><a href="4-errors-and-output.html#errors-and-output" id="toc-errors-and-output"><span class="toc-section-number">4</span> Errors and output</a>
<ul>
<li class="has-sub"><a href="4.1-business-as-usual-exception-handling-dealing-with-errors.html#business-as-usual-exception-handling-dealing-with-errors" id="toc-business-as-usual-exception-handling-dealing-with-errors"><span class="toc-section-number">4.1</span> Business as usual: Exception handling (“dealing with errors”)</a>
<ul>
<li><a href="4.1-business-as-usual-exception-handling-dealing-with-errors.html#example-setup" id="toc-example-setup"><span class="toc-section-number">4.1.1</span> Example setup</a></li>
<li><a href="4.1-business-as-usual-exception-handling-dealing-with-errors.html#exception-handling-works-the-same-with-map-reduce-functions" id="toc-exception-handling-works-the-same-with-map-reduce-functions"><span class="toc-section-number">4.1.2</span> Exception handling works the same with map-reduce functions</a></li>
</ul></li>
<li><a href="4.2-business-as-usual-warnings.html#business-as-usual-warnings" id="toc-business-as-usual-warnings"><span class="toc-section-number">4.2</span> Business as usual: Warnings</a></li>
<li><a href="4.3-business-as-usual-messages.html#business-as-usual-messages" id="toc-business-as-usual-messages"><span class="toc-section-number">4.3</span> Business as usual: Messages</a></li>
<li><a href="4.4-business-as-usual-standard-output.html#business-as-usual-standard-output" id="toc-business-as-usual-standard-output"><span class="toc-section-number">4.4</span> Business as usual: Standard output</a></li>
<li><a href="4.5-summary-all-types-of-output-is-relayed.html#summary-all-types-of-output-is-relayed" id="toc-summary-all-types-of-output-is-relayed"><span class="toc-section-number">4.5</span> Summary: All types of output is relayed</a></li>
<li class="has-sub"><a href="4.6-odds-and-ends.html#odds-and-ends" id="toc-odds-and-ends"><span class="toc-section-number">4.6</span> Odds and ends</a>
<ul>
<li><a href="4.6-odds-and-ends.html#what-about-standard-error-stderr" id="toc-what-about-standard-error-stderr"><span class="toc-section-number">4.6.1</span> What about standard error (stderr)?</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="5-reporting-on-progress-updates.html#reporting-on-progress-updates" id="toc-reporting-on-progress-updates"><span class="toc-section-number">5</span> Reporting on progress updates</a>
<ul>
<li><a href="5.1-basic-progress-updates.html#basic-progress-updates" id="toc-basic-progress-updates"><span class="toc-section-number">5.1</span> Basic progress updates</a></li>
<li><a href="5.2-progress-updates-in-parallel.html#progress-updates-in-parallel" id="toc-progress-updates-in-parallel"><span class="toc-section-number">5.2</span> Progress updates in parallel</a></li>
<li><a href="5.3-customizing-how-progress-is-reported.html#customizing-how-progress-is-reported" id="toc-customizing-how-progress-is-reported"><span class="toc-section-number">5.3</span> Customizing how progress is reported</a></li>
<li><a href="5.4-demo-mandelbrot-sets.html#demo-mandelbrot-sets" id="toc-demo-mandelbrot-sets"><span class="toc-section-number">5.4</span> Demo: Mandelbrot sets</a></li>
</ul></li>
<li class="has-sub"><a href="6-quick-summary-and-comparison-to-other-parallel-frameworks.html#quick-summary-and-comparison-to-other-parallel-frameworks" id="toc-quick-summary-and-comparison-to-other-parallel-frameworks"><span class="toc-section-number">6</span> Quick summary and comparison to other parallel frameworks</a>
<ul>
<li><a href="6.1-feature-comparisons.html#feature-comparisons" id="toc-feature-comparisons"><span class="toc-section-number">6.1</span> Feature comparisons</a></li>
<li><a href="6.2-parallel-backend-comparisons.html#parallel-backend-comparisons" id="toc-parallel-backend-comparisons"><span class="toc-section-number">6.2</span> Parallel-backend comparisons</a></li>
</ul></li>
<li class="has-sub"><a href="7-random-numbers-and-reproducibility.html#random-numbers-and-reproducibility" id="toc-random-numbers-and-reproducibility"><span class="toc-section-number">7</span> Random numbers and reproducibility</a>
<ul>
<li><a href="7.1-why-is-this-important.html#why-is-this-important" id="toc-why-is-this-important"><span class="toc-section-number">7.1</span> Why is this important?</a></li>
<li class="has-sub"><a href="7.2-futures-use-proper-parallel-rng.html#futures-use-proper-parallel-rng" id="toc-futures-use-proper-parallel-rng"><span class="toc-section-number">7.2</span> Futures use proper parallel RNG</a>
<ul>
<li><a href="7.2-futures-use-proper-parallel-rng.html#what-happens-if-you-forget-to-declare-seed-true" id="toc-what-happens-if-you-forget-to-declare-seed-true"><span class="toc-section-number">7.2.1</span> What happens if you forget to declare seed = TRUE?</a></li>
<li><a href="7.2-futures-use-proper-parallel-rng.html#random-numbers-with-parallel-map-reduce-functions" id="toc-random-numbers-with-parallel-map-reduce-functions"><span class="toc-section-number">7.2.2</span> Random numbers with parallel map-reduce functions</a></li>
</ul></li>
</ul></li>
<li><a href="open-discussion.html#open-discussion" id="toc-open-discussion">Open discussion</a></li>
<li class="has-sub"><a href="8-appendix.html#appendix" id="toc-appendix"><span class="toc-section-number">8</span> Appendix</a>
<ul>
<li><a href="8.1-appendix-exception-handling-by-other-parallel-map-reduce-apis.html#appendix-exception-handling-by-other-parallel-map-reduce-apis" id="toc-appendix-exception-handling-by-other-parallel-map-reduce-apis"><span class="toc-section-number">8.1</span> Appendix: Exception handling by other parallel map-reduce APIs</a></li>
<li><a href="8.2-appendix-condition-handling-by-other-parallel-map-reduce-apis.html#appendix-condition-handling-by-other-parallel-map-reduce-apis" id="toc-appendix-condition-handling-by-other-parallel-map-reduce-apis"><span class="toc-section-number">8.2</span> Appendix: Condition handling by other parallel map-reduce APIs</a></li>
<li><a href="8.3-appendix-standard-output-by-other-parallel-map-reduce-apis.html#appendix-standard-output-by-other-parallel-map-reduce-apis" id="toc-appendix-standard-output-by-other-parallel-map-reduce-apis"><span class="toc-section-number">8.3</span> Appendix: Standard output by other parallel map-reduce APIs</a></li>
<li class="has-sub"><a href="8.4-appendix-not-everything-can-be-parallelized.html#appendix-not-everything-can-be-parallelized" id="toc-appendix-not-everything-can-be-parallelized"><span class="toc-section-number">8.4</span> Appendix: Not everything can be parallelized</a>
<ul>
<li><a href="8.4-appendix-not-everything-can-be-parallelized.html#example-r-connections-can-be-exported-to-parallel-workers" id="toc-example-r-connections-can-be-exported-to-parallel-workers"><span class="toc-section-number">8.4.1</span> Example: R connections can be exported to parallel workers</a></li>
<li><a href="8.4-appendix-not-everything-can-be-parallelized.html#example-xml2-objects-cannot-be-exported" id="toc-example-xml2-objects-cannot-be-exported"><span class="toc-section-number">8.4.2</span> Example: xml2 objects cannot be exported</a></li>
</ul></li>
<li><a href="8.5-appendix-careful-with-forked-parallization.html#appendix-careful-with-forked-parallization" id="toc-appendix-careful-with-forked-parallization"><span class="toc-section-number">8.5</span> Appendix: Careful with forked parallization</a></li>
<li class="has-sub"><a href="8.6-appendix-missing-globals.html#appendix-missing-globals" id="toc-appendix-missing-globals"><span class="toc-section-number">8.6</span> Appendix: Missing globals</a>
<ul>
<li><a href="8.6-appendix-missing-globals.html#example-glueglue---object-not-found" id="toc-example-glueglue---object-not-found"><span class="toc-section-number">8.6.1</span> Example: glue::glue() - object not found</a></li>
<li><a href="8.6-appendix-missing-globals.html#example-do.call" id="toc-example-do.call"><span class="toc-section-number">8.6.2</span> Example: do.call()</a></li>
</ul></li>
<li><a href="8.7-appendix-dont-assign-to-global-environment.html#appendix-dont-assign-to-global-environment" id="toc-appendix-dont-assign-to-global-environment"><span class="toc-section-number">8.7</span> Appendix: Don’t assign to global environment</a></li>
<li><a href="8.8-appendix-foreach-is-not-a-for-loop.html#appendix-foreach-is-not-a-for-loop" id="toc-appendix-foreach-is-not-a-for-loop"><span class="toc-section-number">8.8</span> Appendix: foreach() is not a for-loop</a></li>
<li><a href="8.9-appendix-debugging.html#appendix-debugging" id="toc-appendix-debugging"><span class="toc-section-number">8.9</span> Appendix: Debugging</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="appendix-missing-globals" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Appendix: Missing globals</h2>
<p>Objects that needs to be exported to parallel workers are called
“globals”. They are identified by automatically code inspection. This
works most of the time, but there are cases were it might fail. For
example, consider:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="8.6-appendix-missing-globals.html#cb168-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb168-2"><a href="8.6-appendix-missing-globals.html#cb168-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb168-3"><a href="8.6-appendix-missing-globals.html#cb168-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb168-4"><a href="8.6-appendix-missing-globals.html#cb168-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-5"><a href="8.6-appendix-missing-globals.html#cb168-5" aria-hidden="true" tabindex="-1"></a>my_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(var) { <span class="fu">sum</span>(<span class="fu">get</span>(var)) }</span>
<span id="cb168-6"><a href="8.6-appendix-missing-globals.html#cb168-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">my_sum</span>(<span class="at">var =</span> <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<p>In this case, it is impossible for R to know <em>upfront</em> that <code>var = "a"</code> is going to be used to retrieve the value of a global variable.
Because of this, calling:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="8.6-appendix-missing-globals.html#cb169-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">future</span>(<span class="fu">my_sum</span>(<span class="at">var =</span> <span class="st">&quot;a&quot;</span>))</span>
<span id="cb169-2"><a href="8.6-appendix-missing-globals.html#cb169-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">value</span>(f)</span>
<span id="cb169-3"><a href="8.6-appendix-missing-globals.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in get(var) : object &#39;a&#39; not found</span></span></code></pre></div>
<p>fails.</p>
<p>The solution is to guide the <strong><a href="https://future.futureverse.org">future</a></strong> framework to identify <code>a</code> as a global variable. We can do this by adding a dummy use of <code>a</code>, e.g.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="8.6-appendix-missing-globals.html#cb170-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">future</span>({</span>
<span id="cb170-2"><a href="8.6-appendix-missing-globals.html#cb170-2" aria-hidden="true" tabindex="-1"></a>  a  <span class="do">## fake use of &#39;a&#39;</span></span>
<span id="cb170-3"><a href="8.6-appendix-missing-globals.html#cb170-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-4"><a href="8.6-appendix-missing-globals.html#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">my_sum</span>(<span class="at">var =</span> <span class="st">&quot;a&quot;</span>)</span>
<span id="cb170-5"><a href="8.6-appendix-missing-globals.html#cb170-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb170-6"><a href="8.6-appendix-missing-globals.html#cb170-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">value</span>(f)</span></code></pre></div>
<div id="example-glueglue---object-not-found" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Example: glue::glue() - object not found</h3>
<p>Here’s another, more common example:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="8.6-appendix-missing-globals.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb171-2"><a href="8.6-appendix-missing-globals.html#cb171-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">42</span></span>
<span id="cb171-3"><a href="8.6-appendix-missing-globals.html#cb171-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">&quot;The value of a is {a}.&quot;</span>)</span>
<span id="cb171-4"><a href="8.6-appendix-missing-globals.html#cb171-4" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb171-5"><a href="8.6-appendix-missing-globals.html#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The value of a is 42.</span></span></code></pre></div>
<p>If we run this in parallel as-is, the <strong><a href="https://future.futureverse.org">future</a></strong> framework won’t be able to identify <code>a</code> as a needed object;</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="8.6-appendix-missing-globals.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb172-2"><a href="8.6-appendix-missing-globals.html#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb172-3"><a href="8.6-appendix-missing-globals.html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession)</span>
<span id="cb172-4"><a href="8.6-appendix-missing-globals.html#cb172-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-5"><a href="8.6-appendix-missing-globals.html#cb172-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">42</span></span>
<span id="cb172-6"><a href="8.6-appendix-missing-globals.html#cb172-6" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">future</span>(<span class="fu">glue</span>(<span class="st">&quot;The value of a is {a}.&quot;</span>))</span>
<span id="cb172-7"><a href="8.6-appendix-missing-globals.html#cb172-7" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">value</span>(f)</span>
<span id="cb172-8"><a href="8.6-appendix-missing-globals.html#cb172-8" aria-hidden="true" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> text, <span class="at">keep.source =</span> <span class="cn">FALSE</span>), envir) <span class="sc">:</span> </span>
<span id="cb172-9"><a href="8.6-appendix-missing-globals.html#cb172-9" aria-hidden="true" tabindex="-1"></a>  object <span class="st">&#39;a&#39;</span> not found</span></code></pre></div>
<p>As before, we can workaround it by:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="8.6-appendix-missing-globals.html#cb173-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">future</span>({</span>
<span id="cb173-2"><a href="8.6-appendix-missing-globals.html#cb173-2" aria-hidden="true" tabindex="-1"></a>  a  <span class="do">## fake use of &#39;a&#39;</span></span>
<span id="cb173-3"><a href="8.6-appendix-missing-globals.html#cb173-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb173-4"><a href="8.6-appendix-missing-globals.html#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(<span class="st">&quot;The value of a is {a}.&quot;</span>)</span>
<span id="cb173-5"><a href="8.6-appendix-missing-globals.html#cb173-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb173-6"><a href="8.6-appendix-missing-globals.html#cb173-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-7"><a href="8.6-appendix-missing-globals.html#cb173-7" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">value</span>(f)</span>
<span id="cb173-8"><a href="8.6-appendix-missing-globals.html#cb173-8" aria-hidden="true" tabindex="-1"></a>s</span>
<span id="cb173-9"><a href="8.6-appendix-missing-globals.html#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The value of a is 42.</span></span></code></pre></div>
</div>
<div id="example-do.call" class="section level3" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> Example: do.call()</h3>
<p>Function <code>do.call()</code> can be used to call a function with a set of arguments. For example,</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="8.6-appendix-missing-globals.html#cb174-1" aria-hidden="true" tabindex="-1"></a>fcn <span class="ot">&lt;-</span> sum</span>
<span id="cb174-2"><a href="8.6-appendix-missing-globals.html#cb174-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">do.call</span>(fcn, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb174-3"><a href="8.6-appendix-missing-globals.html#cb174-3" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb174-4"><a href="8.6-appendix-missing-globals.html#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 55</span></span></code></pre></div>
<p>calls <code>fcn(1:10)</code> == <code>sum(1:10)</code>. This works in parallel too:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="8.6-appendix-missing-globals.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb175-2"><a href="8.6-appendix-missing-globals.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession)</span>
<span id="cb175-3"><a href="8.6-appendix-missing-globals.html#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="8.6-appendix-missing-globals.html#cb175-4" aria-hidden="true" tabindex="-1"></a>fcn <span class="ot">&lt;-</span> sum</span>
<span id="cb175-5"><a href="8.6-appendix-missing-globals.html#cb175-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">future</span>(<span class="fu">do.call</span>(fcn, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)))</span>
<span id="cb175-6"><a href="8.6-appendix-missing-globals.html#cb175-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">value</span>(f)</span>
<span id="cb175-7"><a href="8.6-appendix-missing-globals.html#cb175-7" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb175-8"><a href="8.6-appendix-missing-globals.html#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 55</span></span></code></pre></div>
<p>As an alternative to a function, <code>do.call()</code> also takes the <em>name</em> of a function as input. For example, we can also do:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="8.6-appendix-missing-globals.html#cb176-1" aria-hidden="true" tabindex="-1"></a>fcn <span class="ot">&lt;-</span> sum</span>
<span id="cb176-2"><a href="8.6-appendix-missing-globals.html#cb176-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;fcn&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb176-3"><a href="8.6-appendix-missing-globals.html#cb176-3" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb176-4"><a href="8.6-appendix-missing-globals.html#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 55</span></span></code></pre></div>
<p>However, this is like the problem of using <code>get()</code>, as explained above. If we try this in parallel, we get:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="8.6-appendix-missing-globals.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb177-2"><a href="8.6-appendix-missing-globals.html#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession)</span>
<span id="cb177-3"><a href="8.6-appendix-missing-globals.html#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="8.6-appendix-missing-globals.html#cb177-4" aria-hidden="true" tabindex="-1"></a>fcn <span class="ot">&lt;-</span> sum</span>
<span id="cb177-5"><a href="8.6-appendix-missing-globals.html#cb177-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">future</span>(<span class="fu">do.call</span>(<span class="st">&quot;fcn&quot;</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)))</span>
<span id="cb177-6"><a href="8.6-appendix-missing-globals.html#cb177-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">value</span>(f)</span>
<span id="cb177-7"><a href="8.6-appendix-missing-globals.html#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in fcn(1:10) : could not find function &quot;fcn&quot;</span></span></code></pre></div>
<p>We could declare by adding a dummy <code>fcn</code>, but it’s much better to never pass the <em>name</em> of a function (<code>"fcn"</code>) to <code>do.call()</code>; it’s always much better to pass the function object (<code>fcn</code>) itself.</p>
<p>The same is true for apply functions, e.g. use:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="8.6-appendix-missing-globals.html#cb178-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">FUN =</span> sum)</span></code></pre></div>
<p>but avoid:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="8.6-appendix-missing-globals.html#cb179-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">FUN =</span> <span class="st">&quot;sum&quot;</span>)</span></code></pre></div>
</div>
</div>
<p style="text-align: center;">
<a href="8.5-appendix-careful-with-forked-parallization.html"><button class="btn btn-default">Previous</button></a>
<a href="8.7-appendix-dont-assign-to-global-environment.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
